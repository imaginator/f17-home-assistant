---
# E: Sequence used for the vacuum each workdays
#
# Inspired by https://community.home-assistant.io/t/howto-xiaomi-vacuum-zoned-cleaning/51293/193?u=oncleben31
# https://www.home-assistant.io/components/script/
# https://www.home-assistant.io/docs/scripts/
# https://github.com/rogro82/hass-variables

alias: Daily cleaning sequence for imagiSuck
sequence:
  # Save vacum states (count, time, area)
  - service: variable.set_variable
    data:
      variable: nb_cleaning_before_daily_routine
      value: "{{ states.sensor.rockrobo_vacuum_v1_total_clean_count.state }}"
      attributes:
        time: "{{ states.sensor.rockrobo_vacuum_v1_total_duration.state }}"
        area: "{{ states.sensor.rockrobo_vacuum_v1_total_clean_area.state }}"

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_catarea
      room_bool: input_boolean.vacuum_can_clean_catarea
      room_name: "Cat Toilet Area"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_bathroommain
      room_bool: input_boolean.vacuum_can_clean_bathroommain
      room_name: "Cat Toilet Area"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_bedroom1
      room_bool: input_boolean.vacuum_can_clean_bedroom1
      room_name: "Bedroom 1"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_bedroom2
      room_bool: input_boolean.vacuum_can_clean_bedroom2
      room_name: "Bedroom 2"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_bedroom3
      room_bool: input_boolean.vacuum_can_clean_bedroom3
      room_name: "Bedroom 3"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_study
      room_bool: input_boolean.vacuum_can_clean_study
      room_name: "Study"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_hallwaylarge
      room_bool: input_boolean.vacuum_can_clean_hallwaylarge
      room_name: "Large Hallway"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_hallwaysmall
      room_bool: input_boolean.vacuum_can_clean_hallwaysmall
      room_name: "Small Hallway"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_bathroomguest
      room_bool: input_boolean.vacuum_can_clean_bathroomguest
      room_name: "Guest Bathroom"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_kitchen
      room_bool: input_boolean.vacuum_can_clean_kitchen
      room_name: "Kitchen"
      room_battery_needed: 13
      repetition: 1

  - service: script.launch_daily_vacuum_in_room
    data:
      room_script: script.launch_vacuum_in_dining
      room_bool: input_boolean.vacuum_can_clean_dining
      room_name: "Dining Area"
      room_battery_needed: 13
      repetition: 1

  # # Notify when finished
  # - service: notify.notify
  #   data:
  #     message: >
  #       Daily Vacuuming is completed by imagiSuck
  #       {{ states.sensor.rockrobo_vacuum_v1_total_clean_count.state | int - states.variable.nb_cleaning_before_daily_routine.state
  #       | int }}